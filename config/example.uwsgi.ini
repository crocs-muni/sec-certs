[uwsgi]
uid = www-data
gid = www-data

plugin = python
base = /var/www/sec-certs

chdir = %(base)
module = sec_certs_page
virtualenv = %(base)/virt
callable = app

enable-threads = true
single-interpreter = true
env = FLASK_ENV=production

pidfile = /run/uwsgi/app/certs/pid
socket = /run/uwsgi/app/certs/socket
chmod-socket = 666
chown-socket = www-data

smart-attach-daemon = /run/uwsgi/app/certs/dramatiq.pid %(virtualenv)/bin/dramatiq sec_certs_page:broker -p 2 -t 1 --pid-file /run/uwsgi/app/certs/dramatiq.pid --log-file /var/log/dramatiq/certs.log
attach-daemon = %(virtualenv)/bin/periodiq sec_certs_page:broker

master = true
workers = 4
