{% extends "base.html.jinja2" %}
{% set crumbs = True %}
{% set search = False %}
{% set canonical = True %}
{% block content %}
    <main>
        <div class="col-10 mx-auto p-3 py-md-5">
            <div class="row mb-3 g-4 justify-content-start row-cols-1 row-cols-lg-2">
                <div class="col-sm-10 col-md-5 order-1 order-md-0">
                    <h1>Vulnerability information</h1>
                    <p class="lead">Vulnerabilities can affect certified devices. We use the data provided
                        by MITRE in the form of the CVE database as well as data provided by NIST in its NVD to map
                        vulnerabilities to certified products.</p>
                </div>
                <div class="col-5 d-flex justify-content-md-center align-items-md-center order-0 order-md-1">
                    <img src="{{ url_for("static", filename="img/cve_logo.svg") }}" alt="CVE"
                         class="part-logo"
                         style="width: 10em"/>
                </div>
            </div>
        </div>
        <div class="row bg-dark p-3 mb-5">
            <div class="col-10 mx-auto">
                <div class="row my-5 row-cols-1 row-cols-lg-2 g-4">
                    <div class="col">
                        <div class="card h-100">
                            <div class="card-body">
                                <h4 class="card-title">CVEs</h4>
                                <p class="card-text">Browse through CVEs and see which certificates they impact.</p>
                                <div class="form-inline">
                                    <input id="cve-input" class="form-control mb-2" placeholder="CVE ID" type="search"
                                           value=""/>
                                    <small class="text-muted">E.g. <span class="font-monospace border rounded" onclick="window.getSelection().selectAllChildren(this)">CVE-2019-15809</span>.</small>
                                    <div class="invalid-feedback">
                                        CVE invalid.
                                    </div>
                                </div>
                                <button id="cve-button" class="btn btn-primary mt-2"><i class="fas fa-search fa-fw"></i> Go
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="card h-100">
                            <div class="card-body">
                                <h4 class="card-title">CPEs</h4>
                                <p class="card-text">Browse through CPEs and see which certificates they match.</p>
                                <div class="form-inline">
                                    <input id="cpe-input" class="form-control mb-2" placeholder="CPE URI" type="search"
                                           value=""/>
                                    <small class="text-muted">E.g. <span class="font-monospace border rounded" onclick="window.getSelection().selectAllChildren(this)">cpe:2.3:a:microchip:atmel_toolbox:00.03.11.05:*:*:*:*:*:*:*</span>.</small>

                                    <div class="invalid-feedback">
                                        CPE invalid.
                                    </div>
                                </div>
                                <button id="cpe-button" class="btn btn-primary mt-2"><i class="fas fa-search fa-fw"></i> Go
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-10 mx-auto">
            <div class="row p-3 py-md-5">
                <div class="col-12 col-md-6">
                    <h3 class="anchor" id="data">Data</h3>
                    <p>The full and up-to-date datasets used on this site can be downloaded here. They are updated daily.</p>
                    <a href="{{ url_for(".cve_dset") }}" role="button" class="btn btn-primary"><i
                            class="fas fa-file-alt"></i>
                        CVE</a>
                    <a href="{{ url_for(".cpe_dset") }}" role="button" class="btn btn-primary"><i
                            class="fas fa-file-alt"></i>
                        CPE</a>
                </div>
            </div>
        </div>
        <script>
            function cve_search() {
                let input = $("#cve-input").val();
                if (!/CVE-[0-9]{4}-[0-9]{1,5}/.test(input)) {
                    $("#cve-input").addClass("is-invalid");
                } else {
                    window.location.href = "{{ url_for("vuln.cve", cve_id="") }}" + input;
                }
            }

            function cpe_search() {
                let input = $("#cpe-input").val();
                if (input === "") {
                    $("#cpe-input").addClass("is-invalid");
                } else {
                    window.location.href = "{{ url_for("vuln.cpe", cpe_id="") }}" + input;
                }
            }

            $("#cve-button").click(cve_search);
            $("#cpe-button").click(cpe_search);
        </script>
    </main>
{% endblock %}
