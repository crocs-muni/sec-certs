{% extends "base.html.jinja2" %}
{% set crumbs = True %}
{% set search = False %}
{% block title %}
    <title>Common Criteria reference network | sec-certs.org</title>
{% endblock %}
{% block head %}
    {{ super() }}
    <script type="text/javascript" src="{{ url_for("static", filename="network.js") }}"></script>
{% endblock %}
{% block content %}
    <main>
        <div class="col-10 mx-auto p-3 py-md-5">
            <h1 class="mb-4">Common Criteria</h1>
            <div class="alert alert-warning d-sm-none" role="alert">
                <i class="fas fa-exclamation-triangle"></i> This page was not yet optimized for use on mobile devices.
            </div>
            <div class="row">
                <div class="col-12 col-md-6">
                    <p>The following interactive graph represents the network of Common Criteria certificate references.
                        Each node represents a certificate and an edge corresponds to one certificate
                        referencing the certificate ID of another one. This reference information
                        is based on a heuristic and is extracted from the certificate report and security target
                        documents, and thus may contain errors.</p>
                    <p><b>Zoom out</b> to see the big picture, <b>move nodes</b> around, and <b>filter</b> them using
                        the controls below.</p>
                    {% if query %}
                        <div class="callout">
                            {% if request.args.get("search") == "basic" %}
                                <p>The certificates shown are part of the results of a search query and their (weak)
                                    reference
                                    graph components. This means that all of the search results are displayed and also
                                    all
                                    certificates transitively referencing or being referenced by the search result
                                    certificates.</p>
                                <a href="{{ url_for(".search") }}?{{ query|safe }}" class="btn btn-warning"
                                   title="Experimental feature" data-bs-toggle="tooltip"><i
                                        class="fas fa-flask fa-fw fa-spin"></i> Go back to search</a>
                            {% elif request.args.get("search") == "fulltext" %}
                                <p>The certificates shown are part of the results of a search query and their (weak)
                                    reference
                                    graph components. This means that all of the search results are displayed and also
                                    all
                                    certificates transitively referencing or being referenced by the search result
                                    certificates.</p>
                                <a href="{{ url_for(".fulltext_search") }}?{{ query|safe }}" class="btn btn-warning"
                                   title="Experimental feature" data-bs-toggle="tooltip"><i
                                        class="fas fa-flask fa-fw fa-spin"></i> Go back to search</a>
                            {% elif request.args.get("search") == "cve" and request.args.get("cve") %}
                                <p>The certificates highlighted are affected by <b>{{ request.args["cve"] }}</b>.
                                    The graph shows them and their (weak) reference
                                    graph components. This means that also all
                                    certificates transitively referencing or being referenced by the affected
                                    certificates.</p>
                                <a href="{{ url_for("vuln.cve", cve_id=request.args["cve"]) }}" class="btn btn-warning"
                                   title="Experimental feature" data-bs-toggle="tooltip"><i
                                        class="fas fa-flask fa-fw fa-spin"></i> Go back to CVE</a>
                            {% endif %}
                            <a href="{{ url_for(".network") }}" class="btn btn-secondary"> Clear</a>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>

        <div class="border">
            <div id="network"></div>
        </div>
        <script>
            let network = createNetwork('network',
                '{{ url_for(".network_graph")}}{% if query %}?{{ query|safe }}{% endif %}',
                '{{ url_for(".categories") }}',
                '{{ url_for(".statuses") }}',
                '{{ url_for(".reference_types") }}',
                600,
                300);
        </script>
    </main>
{% endblock %}
